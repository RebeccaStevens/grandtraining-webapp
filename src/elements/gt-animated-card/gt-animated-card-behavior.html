<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/neon-animation/animations/scale-up-animation.html">
<link rel="import" href="../../../bower_components/neon-animation/animations/scale-down-animation.html">
<link rel="import" href="../../../bower_components/neon-animation/animations/fade-in-animation.html">
<link rel="import" href="../../../bower_components/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../../../bower_components/neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../../../imports/gt.html">

<script>
  GT.AnimatedCardBehaviorImpl = {
    properties: {

      /**
       * States whether or not this element is shown.
       */
      shown: {
        type: Boolean,
        value: false,
        notify: true,
        reflectToAttribute: true
      },

      /**
       * True if in the process of hidden the element.
       */
      _hidding: {
        type: Boolean,
        value: false
      },

      /**
       * The animations this element has.
       */
      animationConfig: {
        value: function() {
          return {
            entry: [
              {
                name: 'scale-up-animation',
                node: this.$.card,
                timing: {
                  delay: 0,
                  duration: GT.animation.entryDuration
                }
              },
              {
                name: 'fade-in-animation',
                node: this.$.card,
                timing: {
                  delay: 0,
                  duration: GT.animation.entryDuration
                }
              }
            ],
            exit: [
              {
                name: 'scale-down-animation',
                node: this.$.card,
                timing: {
                  delay: 0,
                  duration: GT.animation.exitDuration
                }
              },
              {
                name: 'fade-out-animation',
                node: this.$.card,
                timing: {
                  delay: 0,
                  duration: GT.animation.exitDuration
                }
              }
            ],
          };
        }
      }
    },

    listeners: {
      'neon-animation-finish': '_onNeonAnimationFinish'
    },

    /**
     * Show this element.
     */
    show: function() {
      this.shown = true;
      this.cancelAnimation();
      this.playAnimation('entry');
    },

    /**
     * Hide this element.
     */
    hide: function() {
      this._hidding = true;
      this.cancelAnimation();
      this.playAnimation('exit');
    },

    /**
     * Called when an animation finishes playing.
     */
    _onNeonAnimationFinish: function() {
      if (this._hidding) {
        this._hidding = false;
        this.shown = false;
      }
    },

    ready: function() {
      if (this.shown) {
        this.show();
      }
    }
  };

  GT.AnimatedCardBehavior = [
    Polymer.NeonAnimationRunnerBehavior,
    GT.AnimatedCardBehaviorImpl
  ];
</script>
