<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/paper-styles/color.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="../../../styles/gt-styles.html">
<link rel="import" href="../../../imports/gt.html">
<link rel="import" href="../../gt-element-common-behavior.html">
<link rel="import" href="../gt-page-behavior.html">

<dom-module id="gt-page-404">
  <template>
    <style include="gt-styles">
      :host {
        display: block;
        padding: 1em 1.5em 0 1.5em;
        max-width: 1140px;
        margin: 0 auto;
      }
      #message h1 {
        font-size: 42pt;
        color: var(--paper-red-600);
        margin: 0;
        line-height: 1.25em;
      }
      #message h2 {
        font-size: 26pt;
        color: #333;
        text-transform: uppercase;
        margin: 0;
        line-height: 1.25em;
      }
      #message p {
        margin-top: 1em;
        font-size: 10pt;
        color: #999;
        /*text-transform: uppercase;*/
      }
      #message p:first-of-type {
        margin-top: 1.25em;
      }
      #buttons {
        margin-top: 45px;
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
      }
      @media (min-width: 1024px) {
        :host {
          padding: 2em 3.5em 0 3.5em;
        }
        #message h1 {
          font-size: 72pt;
        }
        #message h2 {
          font-size: 38pt;
        }
        #message p {
          font-size: 13pt;
        }
        #buttons {
          margin-top: 65px;
        }
      }
    </style>

    <gt-ajax
      id="pageDataLoader"
      path="error-pages/404.json"
      last-response="{{pageData}}"
      on-response="_handleAjaxResponse"
      on-error="_handleAjaxError"></gt-ajax>
    <div id="message">
      <h1>404</h1>
      <h2>Page not found</h2>
      <p>The page you are looking for doesn't seem to exist.<br>
         It may have been moved, deleted, or may never have existed.</p>
    </div>
    <div id="buttons">
      <a name="classes" href$="[[appConfig.pages.home.url]]" tabindex="-1"><paper-button raised>Back to Home Page</paper-button></a>
    </div>
  </template>

  <script>
    Polymer({
      is: 'gt-page-404',

      behaviors: [
        GT.ElementCommonBehavior,
        GT.PageBehavior
      ],

      /**
       * Called when the page data loads.
       */
      _handleAjaxResponse: function() {
        if (this.pageData) {
          this.$.message.innerHTML = this.pageData.message;
          this.pageReady();
        } else {
          this._handleAjaxError();
        }
      },

      /**
       * Called when an error occurs during the ajax request.
       */
      _handleAjaxError: function() {
        this.pageReady(); // just use the default message
      },

      /**
       * Initialise the page.
       */
      init: function() {
        this.$.pageDataLoader.generateRequest();
      },

      ready: function() {
        this.init();
      }
    });
  </script>
</dom-module>
