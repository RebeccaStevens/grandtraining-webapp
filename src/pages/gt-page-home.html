<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/neon-slideshow/neon-carousel-pages.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/html-echo/html-echo.html">

<link rel="import" href="../gt-page-behavior.html">

<dom-module id="gt-page-home">
  <template>
    <style>
      :host {
        display: block;
      }
      neon-carousel-pages {
        position: relative;
        height: 50vh;
      }
      h1, h2 {
        color: var(--app-primary-header-color);
        text-align: center;
      }
      #title {
        font-size: 22pt;
        margin-top: 0.4em;
        margin-bottom: 0.25em;
      }
      #subtitle {
        font-size: 17pt;
        margin-top: 0;
        margin-bottom: 0.4em;
        line-height: 1.33;
      }
      .cards {
        @apply(--layout-horizontal);
        @apply(--layout-wrap);
        @apply(--layout-center-justified);
        margin-bottom: 0.75em;
      }
      paper-card {
        border-radius: 0.5em;
        margin: 0.75em 0.75em 0 0.75em;
        min-width: 300px;
        max-width: 500px;
        --paper-card-header-text: {
          color: var(--app-secondary-header-color);
          font-size: 18pt;
          padding-bottom: 0;
        };
      }
      paper-card p:first-of-type {
        margin-top: 0;
      }
      paper-card p:last-of-type {
        margin-bottom: 0;
      }
      a {
        text-decoration: none;
      }
      paper-card .card-actions paper-button,
      paper-card .card-actions a:visited paper-button {
        text-transform: capitalize;
        color: var(--app-secondary-color);
        border: solid 1px var(--app-primary-color);
        background-color: var(--app-primary-color-light);
        --paper-button-ink-color: var(--app-primary-color);
      }
      .quote {
        font-style: italic;
      }
      @media (min-width: 1280px) {
        #title {
          font-size: 28pt;
        }
        #subtitle {
          font-size: 22pt;
        }
      }
      @media (min-width: 2560px) {
        #title {
          font-size: 36pt;
        }
        #subtitle {
          font-size: 32pt;
        }
        paper-card {
          max-width: 750px;
        }
      }
    </style>

    <!-- Download data -->
    <iron-ajax
      auto
      url="[[app.dataPath]]home.json"
      handle-as="json"
      last-response="{{pageData}}"
      on-error="_handleAjaxError"></iron-ajax>

    <!-- Layout -->
    <neon-carousel-pages playing delay="6000">
      <template is="dom-repeat" items="[[pageData.carouselImages]]" as="img">
        <iron-image sizing="cover" src="[[img.src]]" preload fade placeholder="[[img.placeholder]]"></iron-image>
      </template>
    </neon-carousel-pages>

    <h1 id="title">[[pageData.welcome]]</h1>
    <h2 id="subtitle">[[app.data.company.slogan]]</h2>

    <div class="cards">
      <template is="dom-repeat" items="[[pageData.cards]]" as="card">
        <paper-card heading="[[card.heading]]" class="flex">
          <div class="card-content"><html-echo html="[[card.content]]"></html-echo></div>
          <template is="dom-if" if="[[_hasKeyValue(card, 'actions')]]">
            <div class="card-actions"><html-echo html="[[card.actions]]"><html-echo></div>
          </template>
        </paper-card>
      </template>
    </div>
  </template>

  <script>
    Polymer({
      is: 'gt-page-home',

      behaviors: [GT.PageBehavior],

      /**
       * Returns whether or not the given object has the given key and the key's value is truthy.
       *
       * {Object} obj
       * {String} key
       */
      _hasKeyValue: function(obj, key) {
        return obj.hasOwnProperty(key) && obj[key];
      }
    });
  </script>
</dom-module>
